<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Closing Sheet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/desktop-style.css" rel="stylesheet">
    <link href="/css/sidebar.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left {
            flex: 1;
        }

        .header-center {
            flex: 1;
            text-align: center;
        }

        .header-right {
            flex: 1;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        /* Tab Navigation - Horizontal Layout */
        .nav-tabs {
            display: flex !important;
            flex-direction: row !important;
            flex-wrap: nowrap !important;
            align-items: stretch !important;
            justify-content: flex-start !important;

            overflow-x: auto !important;
            overflow-y: hidden !important;
            white-space: nowrap !important;

            border-bottom: 2px solid #dee2e6 !important;
            background: #f8f9fa !important;

            padding: 0 !important;
            margin: 0 !important;
            gap: 0 !important;
        }

        .nav-tabs::-webkit-scrollbar {
            height: 6px;
        }

        .nav-tabs::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .nav-tabs::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        .nav-tabs::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .nav-tabs .nav-item {
            display: flex !important;
            flex: 0 0 auto !important;
            width: auto !important;
            margin: 0 !important;
            padding: 0 !important;
            border: none !important;
            background: transparent !important;
        }

        .nav-tabs .nav-link {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;

            border-radius: 0 !important;
            border: 1px solid #dee2e6 !important;
            border-right: none !important;
            border-bottom: none !important;

            padding: 8px 16px !important;
            margin: 0 !important;

            color: #495057 !important;
            background: #e9ecef !important;
            font-weight: 500 !important;
            font-size: 0.875rem !important;
            white-space: nowrap !important;

            transition: all 0.2s ease !important;
            height: 100% !important;
        }

        /* Add right border to last tab only */
        .nav-tabs .nav-item:last-child .nav-link {
            border-right: 1px solid #dee2e6 !important;
        }

        .nav-tabs .nav-link:hover {
            background: #d4d7db !important;
            color: #212529 !important;
        }

        .nav-tabs .nav-link.active {
            background-color: #007bff !important;
            color: white !important;
            border-color: #007bff !important;
            font-weight: 600 !important;
            box-shadow: none !important;
            z-index: 2 !important;
        }

        .tab-content {
            border: 1px solid #dee2e6;
            border-top: none;
            padding: 15px;
            background: white;
            min-height: 400px;
        }

        .blue-header {
            background: #007bff;
            color: white;
            padding: 5px 10px;
            font-weight: bold;
        }

        .form-control-sm {
            border-radius: 0;
            font-size: 0.85rem;
        }

        .total-row {
            background: #e9ecef;
            font-weight: bold;
        }

        .green-total {
            background: #28a745;
            color: white;
            font-weight: bold;
        }

        .red-total {
            background: #dc3545;
            color: white;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <div class="page-header">
        <div class="header-left">
            <i class="fas fa-file-invoice-dollar me-2"></i> Closing Sheet
        </div>
        <div class="header-center">
            <a href="/main.html" class="btn btn-outline-light btn-sm"><i class="fas fa-home"></i> Home Page</a>
        </div>
        <div class="header-right">
            <i class="fas fa-user-circle"></i> <span id="userName">User</span>
        </div>
    </div>

    <div class="container-fluid p-3">
        <!-- Top Controls -->
        <div class="card mb-3 p-3">
            <div class="row align-items-center g-3">
                <div class="col-md-3">
                    <label class="fw-bold me-2">Branch</label>
                    <select id="branch" class="form-select form-select-sm d-inline-block w-auto">
                        <option value="F-6">F-6</option>
                        <option value="G-10">G-10</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <label class="fw-bold me-2">Date</label>
                    <input type="date" id="date" class="form-control form-control-sm d-inline-block w-auto">
                </div>
                <div class="col-md-2">
                    <button class="btn btn-success btn-sm" onclick="loadSheet()">Search</button>
                    <button class="btn btn-primary btn-sm ms-2" onclick="saveSheet()">Save (alt+d)</button>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dept-opening-tab" data-bs-toggle="tab"
                    data-bs-target="#dept-opening" type="button" role="tab">Department Opening</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="closing01-tab" data-bs-toggle="tab" data-bs-target="#closing01"
                    type="button" role="tab">Closing 01</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="closing02-tab" data-bs-toggle="tab" data-bs-target="#closing02"
                    type="button" role="tab">Closing 02</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="sms-sending-tab" data-bs-toggle="tab" data-bs-target="#sms-sending"
                    type="button" role="tab">SMS Sending</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="income-statement-tab" data-bs-toggle="tab"
                    data-bs-target="#income-statement" type="button" role="tab">Income Statement</button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="reporting-tab" data-bs-toggle="tab" data-bs-target="#reporting"
                    type="button" role="tab">Reporting</button>
            </li>
        </ul>

        <div class="tab-content" id="myTabContent">
            <!-- Tab 1: Department Opening -->
            <div class="tab-pane fade show active" id="dept-opening" role="tabpanel">
                <div class="d-flex justify-content-between mb-2">
                    <input type="text" placeholder="Search..." class="form-control form-control-sm"
                        style="width: 300px;">
                    <div>
                        <button class="btn btn-success btn-sm" id="saveBtn" onclick="saveSheet()">Save (alt+d)</button>
                        <button class="btn btn-primary btn-sm" onclick="printSheet('opening')">Print</button>
                    </div>
                </div>
                <div class="blue-header mb-0 row mx-0">
                    <div class="col-2">ID</div>
                    <div class="col-8">Department</div>
                    <div class="col-2 text-end">Amount</div>
                </div>
                <div id="deptOpeningRows">
                    <!-- JS Generated -->
                </div>
                <div class="row mx-0 mt-2 fw-bold">
                    <div class="col-10 text-end">Total</div>
                    <div class="col-2 text-end" id="deptOpeningTotal">0.00</div>
                </div>
            </div>

            <!-- Tab 2: Closing 01 -->
            <div class="tab-pane fade" id="closing01" role="tabpanel">
                <div class="blue-header mb-3">Closing 01</div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="row mb-2 align-items-center">
                            <label class="col-sm-4 fw-bold">Opening Cash</label>
                            <div class="col-sm-8">
                                <input type="number" id="openingCash" class="form-control form-control-sm bg-light"
                                    value="0">
                            </div>
                        </div>
                        <div class="row mb-2 align-items-center">
                            <label class="col-sm-4 fw-bold">Received Cash</label>
                            <div class="col-sm-8">
                                <input type="number" id="receivedCash" class="form-control form-control-sm bg-light"
                                    value="0" readonly>
                            </div>
                        </div>

                        <div class="blue-header mt-4 mb-0 row mx-0">
                            <div class="col-8">Department</div>
                            <div class="col-4 text-end">Amount</div>
                        </div>
                        <div id="closing01DeptRows">
                            <!-- JS Generated -->
                        </div>
                        <div class="row mx-0 mt-2 green-total p-2">
                            <div class="col-8">Total Closing 01</div>
                            <div class="col-4 text-end" id="totalClosing01">0</div>
                        </div>

                        <div class="row mx-0 mt-2 red-total p-2">
                            <div class="col-4">Total</div>
                            <div class="col-8 text-end" id="grandTotal">0</div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="row mb-2 align-items-center">
                            <label class="col-sm-4 fw-bold">Department Total</label>
                            <div class="col-sm-8">
                                <input type="number" id="departmentTotal" class="form-control form-control-sm bg-light"
                                    readonly value="0">
                            </div>
                        </div>
                        <div class="row mb-2 align-items-center">
                            <label class="col-sm-4 fw-bold">Counter Cash Total</label>
                            <div class="col-sm-8">
                                <input type="number" id="counterCashTotal" class="form-control form-control-sm bg-light"
                                    readonly value="0">
                            </div>
                        </div>
                        <div class="row mb-2 align-items-center">
                            <label class="col-sm-4 fw-bold">Percentage_Cash_Total (+)</label>
                            <div class="col-sm-8">
                                <input type="number" id="percentageCashTotal"
                                    class="form-control form-control-sm bg-light" readonly value="0">
                            </div>
                        </div>

                        <div class="row mb-2 align-items-center mt-4">
                            <label class="col-sm-4 fw-bold">Total Closing 02</label>
                            <div class="col-sm-8">
                                <input type="number" id="totalClosing02"
                                    class="form-control form-control-sm green-total text-white border-0" value="0">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tab 3: Closing 02 -->
            <div class="tab-pane fade" id="closing02" role="tabpanel">
                <div class="row">
                    <!-- Left Container - ALL FIELDS -->
                    <div class="col-md-6">
                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Department</label>
                            <div class="col-8">
                                <select id="closing02Dept" class="form-select form-select-sm">
                                    <option value="">Select Department</option>
                                </select>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Counter Closing</label>
                            <div class="col-8">
                                <input type="number" id="counterClosing"
                                    class="form-control form-control-sm bg-info text-white fw-bold" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Total</label>
                            <div class="col-8">
                                <input type="number" id="closing02Total"
                                    class="form-control form-control-sm bg-success text-white fw-bold" value="0"
                                    readonly>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">LP</label>
                            <div class="col-8">
                                <input type="number" id="lp" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Misc (-)</label>
                            <div class="col-8">
                                <input type="number" id="misc" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Total</label>
                            <div class="col-8">
                                <input type="number" id="closing02GrandTotal"
                                    class="form-control form-control-sm bg-success text-white fw-bold" value="0"
                                    readonly>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Received Cash</label>
                            <div class="col-8">
                                <input type="number" id="receivedCashC02"
                                    class="form-control form-control-sm bg-info text-white" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Opening (-)</label>
                            <div class="col-8">
                                <input type="number" id="openingMinus"
                                    class="form-control form-control-sm bg-primary text-white" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Total Sale Computer</label>
                            <div class="col-8">
                                <input type="number" id="totalSaleComputer"
                                    class="form-control form-control-sm bg-info text-white" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Gross Sale</label>
                            <div class="col-8">
                                <input type="number" id="grossSale" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Discount Per</label>
                            <div class="col-8">
                                <input type="number" step="0.01" id="discountPer"
                                    class="form-control form-control-sm bg-info text-white" value="0.00">
                            </div>
                        </div>

                        <!-- RIGHT SIDE FIELDS MOVED TO LEFT -->
                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Bank Total</label>
                            <div class="col-8">
                                <input type="number" id="bankTotal"
                                    class="form-control form-control-sm bg-info text-white fw-bold" value="0" readonly>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Coin</label>
                            <div class="col-8">
                                <input type="number" id="coin" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Dis & C.S</label>
                            <div class="col-8">
                                <input type="number" id="divCS" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Total</label>
                            <div class="col-8">
                                <input type="number" id="totalC02"
                                    class="form-control form-control-sm bg-success text-white fw-bold" value="0"
                                    readonly>
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">T.Sale Manual</label>
                            <div class="col-8">
                                <input type="number" id="tSaleManual"
                                    class="form-control form-control-sm bg-warning text-dark" value="0">
                            </div>
                        </div>

                        <div class="row mb-2">
                            <label class="col-4 fw-bold">Difference</label>
                            <div class="col-8">
                                <input type="number" id="difference"
                                    class="form-control form-control-sm bg-danger text-white fw-bold" value="0"
                                    readonly>
                            </div>
                        </div>

                        <div class="row mb-3">
                            <label class="col-4 fw-bold">Discount Value</label>
                            <div class="col-8">
                                <input type="number" id="discountValue" class="form-control form-control-sm" value="0">
                            </div>
                        </div>

                        <div class="mt-3">
                            <button class="btn btn-success btn-sm" onclick="saveSheet()"><i class="fas fa-save"></i>
                                Save (alt+S)</button>
                            <button class="btn btn-primary btn-sm" onclick="printSheet('closing02')"><i
                                    class="fas fa-print"></i> Print</button>
                        </div>
                    </div>

                    <!-- Right Container - BOTH TABLES -->
                    <div class="col-md-6">
                        <!-- Department Table (Dynamic) -->
                        <div class="mb-3">
                            <table class="table table-bordered table-sm mb-0">
                                <thead class="table-info">
                                    <tr>
                                        <th>Department</th>
                                        <th class="text-end">Sale</th>
                                    </tr>
                                </thead>
                                <tbody id="closing02DeptTable">
                                    <tr>
                                        <td colspan="2" class="text-center text-muted">No data</td>
                                    </tr>
                                </tbody>
                                <tfoot class="table-success">
                                    <tr>
                                        <th>Total</th>
                                        <th class="text-end" id="closing02DeptTotal">0</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>

                        <!-- Bank Table (Dynamic) -->
                        <div class="mb-3">
                            <table class="table table-bordered table-sm mb-0">
                                <thead class="table-info">
                                    <tr>
                                        <th>Bank</th>
                                        <th class="text-end">Amount</th>
                                    </tr>
                                </thead>
                                <tbody id="closing02BankTable">
                                    <tr>
                                        <td colspan="2" class="text-center text-muted">No data</td>
                                    </tr>
                                </tbody>
                                <tfoot class="table-success">
                                    <tr>
                                        <th>Total</th>
                                        <th class="text-end" id="closing02BankTotal">0</th>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Tab 6: SMS Sending -->
            <div class="tab-pane fade" id="sms-sending" role="tabpanel">
                <div class="blue-header mb-3">Customer SMS</div>

                <div class="row mb-3">
                    <div class="col-md-4">
                        <label class="fw-bold">Type</label>
                        <select id="smsType" class="form-select form-select-sm">
                            <option value="Daily Sale">Daily Sale</option>
                            <option value="Cash Activity">Cash Activity</option>
                            <option value="Bank Activity">Bank Activity</option>
                            <option value="Salesman Sale">Salesman Sale</option>
                            <option value="Income Statement">Income Statement</option>
                            <option value="Daily Change">Daily Change</option>
                            <option value="Zakat">Zakat</option>
                            <option value="Department Wise Sale and Activity">Department Wise Sale and Activity</option>
                        </select>
                    </div>
                </div>

                <div class="table-responsive">
                    <table class="table table-bordered table-sm">
                        <thead class="table-primary">
                            <tr>
                                <th width="50"><input type="checkbox" id="selectAllSMS"></th>
                                <th>Customer Name</th>
                                <th>Phone No</th>
                                <th>Mobile No</th>
                                <th>Address</th>
                            </tr>
                        </thead>
                        <tbody id="smsCustomersBody">
                            <tr>
                                <td colspan="5" class="text-center text-muted">Loading customers...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="mt-3">
                    <button class="btn btn-success btn-sm" onclick="sendSMS()">Send SMS</button>
                </div>
            </div>
            <!-- Tab 7: Income Statement -->
            <div class="tab-pane fade" id="income-statement" role="tabpanel">
                <div class="blue-header mb-3">Income Statement</div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="card bg-success text-white mb-3">
                            <div class="card-header fw-bold">Income</div>
                            <div class="card-body">
                                <div class="row mb-2">
                                    <label class="col-6">Opening</label>
                                    <div class="col-6">
                                        <input type="number" id="incomeOpening" class="form-control form-control-sm"
                                            value="0">
                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <label class="col-6">Cash Sale</label>
                                    <div class="col-6">
                                        <input type="number" id="incomeCashSale" class="form-control form-control-sm"
                                            value="0">
                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <label class="col-6">Bank Sale</label>
                                    <div class="col-6">
                                        <input type="number" id="incomeBankSale" class="form-control form-control-sm"
                                            value="0">
                                    </div>
                                </div>

                                <div class="blue-header mt-3 mb-2 p-2">
                                    <div class="row">
                                        <div class="col-3">Detail</div>
                                        <div class="col-3">Head</div>
                                        <div class="col-3">Sub Head</div>
                                        <div class="col-3">Amount</div>
                                    </div>
                                </div>
                                <div id="incomeDetailsRows">
                                    <div class="row mb-1">
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Detail"></div>
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Head"></div>
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Sub"></div>
                                        <div class="col-3"><input type="number" class="form-control form-control-sm"
                                                value="0"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6">
                        <div class="card bg-danger text-white mb-3">
                            <div class="card-header fw-bold">Pay</div>
                            <div class="card-body">
                                <div class="blue-header mt-0 mb-2 p-2">
                                    <div class="row">
                                        <div class="col-3">Detail</div>
                                        <div class="col-3">Head</div>
                                        <div class="col-3">Sub Head</div>
                                        <div class="col-3">Amount</div>
                                    </div>
                                </div>
                                <div id="payDetailsRows">
                                    <div class="row mb-1">
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Detail"></div>
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Head"></div>
                                        <div class="col-3"><input type="text" class="form-control form-control-sm"
                                                placeholder="Sub"></div>
                                        <div class="col-3"><input type="number" class="form-control form-control-sm"
                                                value="0"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6 offset-md-3">
                        <div class="card bg-success text-white">
                            <div class="card-header fw-bold text-center">Difference</div>
                            <div class="card-body">
                                <div class="row mb-2">
                                    <label class="col-6">Income</label>
                                    <div class="col-6">
                                        <input type="number" id="diffIncome"
                                            class="form-control form-control-sm bg-primary text-white" value="0"
                                            readonly>
                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <label class="col-6">Expense</label>
                                    <div class="col-6">
                                        <input type="number" id="diffExpense" class="form-control form-control-sm"
                                            value="0" readonly>
                                    </div>
                                </div>
                                <div class="row mb-2">
                                    <label class="col-6 fw-bold">Balance</label>
                                    <div class="col-6">
                                        <input type="number" id="diffBalance"
                                            class="form-control form-control-sm bg-success text-white fw-bold" value="0"
                                            readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-3">
                    <button class="btn btn-success btn-sm" onclick="saveSheet()">Save</button>
                    <button class="btn btn-primary btn-sm" onclick="printSheet('income')">Print</button>
                    <button class="btn btn-info btn-sm" onclick="printSheet('dayWisePrint')">Day Wise Print</button>
                </div>
            </div>
            <!-- Tab 8: Reporting -->
            <div class="tab-pane fade" id="reporting" role="tabpanel">
                <div class="blue-header mb-3">Reporting</div>

                <div class="row mb-4">
                    <div class="col-md-3">
                        <button class="btn btn-primary w-100" onclick="generateReport('openingBalance')">
                            Opening Balance & Received Cash Detail
                        </button>
                    </div>
                    <div class="col-md-2">
                        <label class="fw-bold">From</label>
                        <input type="date" id="reportFromDate" class="form-control form-control-sm">
                    </div>
                    <div class="col-md-2">
                        <label class="fw-bold">To</label>
                        <input type="date" id="reportToDate" class="form-control form-control-sm">
                    </div>
                    <div class="col-md-3">
                        <label class="fw-bold">&nbsp;</label>
                        <button class="btn btn-info w-100" onclick="generateReport('deptWisePercentage')">
                            Daily Department Wise Percentage Cash Detail
                        </button>
                    </div>
                </div>

                <div id="reportOutput" class="border p-3 bg-white" style="min-height: 400px;">
                    <p class="text-muted text-center">Select a report type and date range to generate report</p>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/js/pageAccess.js"></script>
    <script src="/js/sidebar.js"></script>
    <script src="/js/closing-sheet.js"></script>
</body>

</html>